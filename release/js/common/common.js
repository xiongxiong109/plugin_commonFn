function Count(){this.defaults={btn:null,time:30,unlock:!0,countTag:"Count",refresh:!0}}function getItem(t){return window.localStorage?window.localStorage.getItem(t):getCookie(t)}function setItem(t,e){window.localStorage?window.localStorage.setItem(t,e):setCookie(t,e,time)}function removeItem(t){window.localStorage?window.localStorage.removeItem(t):removeCookie(t)}function getCookie(t){var e,n=new RegExp("(^| )"+t+"=([^;]*)(;|$)");return(e=document.cookie.match(n))?unescape(e[2]):null}function setCookie(t,e,n){document.cookie=t+"="+e+";expires="+1e3*n}function removeCookie(t){setCookie(t,null,-1)}function bind(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,function(){n&&n.call(t)})}function unbind(t,e,n){t.removeEventListener?t.removeEventListener(e,n):t.detachEvent("on"+e,n)}function FormValidator(){this.items=[]}Count.prototype.init=function(t){this.opt=this.extend(this.defaults,t);document.getElementById(this.opt.btn);if(getItem(this.opt.countTag))if(this.opt.refresh){var e=(new Date).getTime();this.countTime(e)}else removeItem(this.opt.countTag);else this.bindEvent(this.opt.btn)},Count.prototype.bindEvent=function(t){function e(){("function"==typeof i.opt.unlock&&i.opt.unlock()||1==i.opt.unlock)&&n.call(o)}function n(){this.setAttribute("disabled","disabled"),i.countTime((new Date).getTime()),unbind(this,"click",e)}var o=null,i=this;o=document.getElementById(t),bind(o,"click",e)},Count.prototype.countTime=function(t){function e(){var t=(new Date).getTime(),e=i.time-Math.floor((t-a)/1e3);u.value=e+"s再获取",0>=e&&(n(),o.bindEvent(i.btn))}function n(){l=0,clearInterval(r),removeItem(i.countTag),u.removeAttribute("disabled"),u.value="获取验证码"}var o=this,i=this.opt,r=null,u=document.getElementById(i.btn);getItem(i.countTag)||setItem(i.countTag,t,i.time);var a=getItem(i.countTag),c=(new Date).getTime(),l=i.time-Math.floor((c-a)/1e3);e(),0>=l?n():(u.setAttribute("disabled","disabled"),r=setInterval(e,1e3))},Count.prototype.clear=function(){var t=this.opt;removeItem(t.countTag)},Count.prototype.extend=function(t,e){for(var n in e)t[n]=e[n];return t},FormValidator.prototype.add=function(t){var e=this.items;if(t.length)for(var n=0;n<t.length;n++)e.push(t[n]);else e.push(t)},FormValidator.prototype.valid=function(t,e){for(var n=this.items,o=0,i=0;i<n.length;i++){if(n[i].name===e){o=i;break}if(i>=n.length-1)return console.error("please use add function to get the '"+e+"' first!"),!1}var r=n[i].reg,u=n[i].msg;if(r.required&&""==t)return u.required;for(var i in r)if("required"!=i&&!r[i].test(t))return u[i];return!0};